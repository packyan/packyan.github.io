NeurIPS-W_2018_Towards Sparse Hierarchical Graph Classifiers

 

图表上表示学习的最新进展，主要是利用图形卷积网络，为许多基于图形的基准任务带来了实质性的改进。虽然学习节点嵌入的新方法非常适合于节点分类和链接预测，但它们在图形分类（预测整个图形的单个标签）中的应用仍然基本上是基本的，通常使用单个全局池步骤来聚合节点特征或手 - 用于图结构的分层粗化的设计的固定启发式算法。改善这一点的一个重要步骤是可微分图粗化 - 在图神经网络流水线中以自适应的，数据相关的方式减小图的大小的能力，类似于CNN内的图像下采样。但是，之前突出的汇集方法在训练期间具有二次内存要求，因此无法扩展到大型图形。在这里，我们结合了图神经网络设计的几个最新进展，以证明竞争的分层图分类结果是可能的，而不会牺牲稀疏性。我们的结果在几个已建立的图分类基准上得到验证，并突出了未来基于图的神经网络研究的重要方向。

 

 

提出的

Pooling layer top-k pooling

 

取出最重要的k个节点，其余节点直接丢弃， 选择中的top-k pooling 节点的特征，经过线性变换或者softmax 然后激活函数，与原始特征相乘，得到新的特征，在池化的同时，做了一次特征的变换。

因为topk的这个特性所以作者后续的文章说这是一种attention机制？

Understanding Attention and Generalization

in Graph Neural Networks

 

为了确保**图下采样层**相对于一大类图形大小和结构具有惯用性，

 

我们采用了使用池化比率k （0; 1）来减少图的方法。这意味着具有N个节点的图在应用这样的池化层之后，节点将具有 kN 节点。

 

 

与DiffPool不同，DiffPool 它试图通过计算**N****个节点到****kN****的聚类**来做到这一点（因此在存储集群分配分数时会产生二次惩罚），我们最近提出了Graph U-Net架构[1]，它简单地丢弃 drops 原始图中的 

N - KN 个节点 

 

基于针对可学习矢量（learnable vector）的投影得分（projection score）来选择要丢弃的节点。

 

![img](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAcCAIAAAAIkcNzAAAAAXNSR0IArs4c6QAAAHhlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAABgAAAAAQAAAGAAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAABGgAwAEAAAAAQAAABwAAAAAqtGPQAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAiBJREFUOBFj/P//PwOJgIlE9SDl5OhhIc2e/y9PrLhCoj3/P91e1coADAMs4O+tRQEKOJ2ARQNOod+vDrY6qgaT4rb/j/fNPGc3Zwoj0FCcbsAhQYo9MCNQw/r/x6vL+ufc+PR07zeP2R2xQhenNy25LyPz/9QlxqjG5jAdHkawPmQP/727JK7+4Md/j9bGKTMYOoYWLr36+Q9Qwb+naxMFjTM3P/oHVo3sth93DpzV9TXg+//1w4tvDBweRQ3hWjzMQJMZxeS1hM4uXnbsMdjvyHq+f2ayctXk/f/y2uFjn/WDnAz5QBpA4NvH198Yvpx6/PoviIesR9A4IUSf6//n62d2flF3N1JgBykAgb9Pbh17zsCgIy4ENgRZD0TBh4sHDjznMTXXFIDwGRh+Pjp75AiDoJWTrjQ4DDD0/H12df8NBitTHXFYkP5/dmr7CQbBiOIQbTaIMcjhBgqie4v8GRgUWo7/gEr8+3qmx5JBNXzule8QkX8f0NLo75eb8wWBhln2nPkKDNh/v5/tqnPUcKzb9ew3JJz/fT3eBnMA1O0frhw+8l4wf3mb6JLs4h0qf07t/W5btH6TtwY0NhkY2OTNUO35cbpbn4fBf9E9iKFo7oZxUcLg38NLuy+y2ngYykHSCCzg0GhkPb+enD96jEHDUVsKFpdoimFcaGC82tuaEOygzMPAIGnsHZXQuvcVbufRK/8g+wfmXEI0OXoARD+aShiLOHsAAAAASUVORK5CYII=)

为了使梯度能够流入

![img](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAcCAIAAAAIkcNzAAAAAXNSR0IArs4c6QAAAHhlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAABgAAAAAQAAAGAAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAABGgAwAEAAAAAQAAABwAAAAAqtGPQAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAiBJREFUOBFj/P//PwOJgIlE9SDl5OhhIc2e/y9PrLhCoj3/P91e1coADAMs4O+tRQEKOJ2ARQNOod+vDrY6qgaT4rb/j/fNPGc3Zwoj0FCcbsAhQYo9MCNQw/r/x6vL+ufc+PR07zeP2R2xQhenNy25LyPz/9QlxqjG5jAdHkawPmQP/727JK7+4Md/j9bGKTMYOoYWLr36+Q9Qwb+naxMFjTM3P/oHVo3sth93DpzV9TXg+//1w4tvDBweRQ3hWjzMQJMZxeS1hM4uXnbsMdjvyHq+f2ayctXk/f/y2uFjn/WDnAz5QBpA4NvH198Yvpx6/PoviIesR9A4IUSf6//n62d2flF3N1JgBykAgb9Pbh17zsCgIy4ENgRZD0TBh4sHDjznMTXXFIDwGRh+Pjp75AiDoJWTrjQ4DDD0/H12df8NBitTHXFYkP5/dmr7CQbBiOIQbTaIMcjhBgqie4v8GRgUWo7/gEr8+3qmx5JBNXzule8QkX8f0NLo75eb8wWBhln2nPkKDNh/v5/tqnPUcKzb9ew3JJz/fT3eBnMA1O0frhw+8l4wf3mb6JLs4h0qf07t/W5btH6TtwY0NhkY2OTNUO35cbpbn4fBf9E9iKFo7oZxUcLg38NLuy+y2ngYykHSCCzg0GhkPb+enD96jEHDUVsKFpdoimFcaGC82tuaEOygzMPAIGnsHZXQuvcVbufRK/8g+wfmXEI0OXoARD+aShiLOHsAAAAASUVORK5CYII=)

投影得分（projection score）也被用作门控值 gating values，使得保留得分较低的节点将经历不太重要的特征保留。

 

完全写出来，该汇集层的操作（从输入图中计算汇集图（X0; A0），（X; A））可以表示如下：

![Xfi  i top-k(y, k) ](data:image/png;base64,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)

 

X特征矩阵，乘以一个可学习向量P,归一化，得到一个 投影得分

 

根据投影得分，选出最大的K个, k=⌈ratio⋅N⌉

得到符合要求的K个点的索引

 

然后对于这K个点， 特征向量进行非线性化处理

![img](data:image/png;base64,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)

同时 邻接矩阵重新生成

![img](data:image/png;base64,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)

 

这里，||·||是L2范数，top-k从给定输入矢量中选择前k个索引，⭕ 是（广播）元素乘法，并且~i是索引操作，其在由~i指定的索引处获取切片。该操作仅需要逐点投影操作并切入原始特征和邻接矩阵，因此平凡地保留稀疏性。

 